<!DOCTYPE html> 
<html>
<head>
	<title>Traildevils - JavaScript Unit-Tests</title>
	<!-- Sencha libs -->
	<script src="../../lib/sencha-touch-1.1.1/sencha-touch.js" type="text/javascript"></script> 

	<!-- JS under test -->
	<script type="text/javascript" src="../../js/functions.js"></script>
	<script type="text/javascript" src="../../js/util/TrailGeoLocation.js"></script>
	

	<!-- QUnit -->
	<link rel="stylesheet" href="../lib/qunit/qunit.css" type="text/css" media="screen" />
	<script type="text/javascript" src="../lib/qunit/qunit.js"></script>
	<script type="text/javascript" src="../lib/jquery/jquery.js"></script>

	<script type="text/javascript">
		//traildevils.launch = null;
	</script>

	<script>
		module("Functions");
		test("Existance of toRad", function() {
				ok(typeof Number.prototype.toRad=="function",'Function toRad() should exist');
		});
		test("toRad - PI", function() {
				var deg = 180;
				equal(deg.toRad(),Math.PI,'180 degrees should equal pi rad');
		});
		test("toRad - One", function() {
				var deg = 1;
				equal(deg.toRad() * 180,Math.PI,'1 degree should equal pi rad / 180');
		});
		module("TrailGeoLocation");
		test("Construtor", function() {
				var geo = new traildevils.util.TrailGeoLocation;
				ok(geo instanceof Ext.util.GeoLocation,'Object should be of Ext.util.GeoLocation or one of it\'s childs');
		});
		test("getDistance", function() {
				var geo = new traildevils.util.TrailGeoLocation;
				//distance Zurich <-> Rapperswil
				geo.latitude = 47.223357;
				geo.longitude = 8.816614;
				var distance = geo.getDistance(47.344192, 8.531436);
				
				var margin = 100;
				var expected = 25300;
				console.log(distance);
				ok((distance <= expected + margin && distance >= expected - margin),'The calculated distance (' + distance + ') should be within the given margin (' + expected + '+-' + margin + ')');
		});
		test("getDistance (no distance)", function() {
				var geo = new traildevils.util.TrailGeoLocation;
				var lat = 47.223357;
				var lng = 8.816614;
				
				geo.latitude = lat;
				geo.longitude = lng;
				equal(geo.getDistance(lat, lng),0,'There is no distance between the given points');
		});
		test("getFormattedDistance (meter)", function() {
				var geo = new traildevils.util.TrailGeoLocation;
				var distance = 203.71342;
				
				equal(geo.getFormattedDistance(distance),'204m','Format distance in meter');
		});
		test("getFormattedDistance (kilometer)", function() {
				var geo = new traildevils.util.TrailGeoLocation;
				var distance = 25203.2343;
				
				equal(geo.getFormattedDistance(distance),'25.2km','Format distance in kilometers');
		});
		test("getFormattedDistance (round up)", function() {
				var geo = new traildevils.util.TrailGeoLocation;
				
				var distance = 3563.124;
				equal(geo.getFormattedDistance(distance),'3.6km','Value should round to next integer');
		});
		test("getFormattedDistance (round down)", function() {
				var geo = new traildevils.util.TrailGeoLocation;
				
				var distance = 3.045;
				equal(geo.getFormattedDistance(distance),'3m','Value should be rounded to this integer');
		});
	</script>
  
</head>
<body>
  <h1 id="qunit-header">Traildevils - JavaScript Unit-Tests</h1>
 <h2 id="qunit-banner"></h2>
 <div id="qunit-testrunner-toolbar"></div>
 <h2 id="qunit-userAgent"></h2>
 <ol id="qunit-tests"></ol>
 <div id="qunit-fixture">test markup, will be hidden</div>
</body>
</html>

